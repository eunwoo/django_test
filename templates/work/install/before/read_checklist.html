<!-- Safety form page -->
{% extends 'base/head.html' %}
{% load static %}
{% block title %}
설치작업 전 체크리스트
{% endblock %}
{% block style %}
<style>
  main {
    width: 70%;
    min-width: 1200px;
    margin: 20px auto;
  }
</style>
<link type="text/css" rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="{% static '/css/image-uploader.min.css' %}">
{% endblock %}

{% block content %}
{% include 'base/header.html' %}
<main>
  <div class="cont mt-4">
    {% include 'base/navbar_main.html' %}
    <section>
      <div class="container">
        <div class="row ml-0">
          <div class="col">
            <nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
              <ol class="breadcrumb">
                <li class="breadcrumb-item">
                  <a href="{% url 'work:index' %}">업무</a>
                </li>
                <li class="breadcrumb-item">
                  <a href="{% url 'work:install_check' %}">설치작업 점검</a>
                </li>
                <li class="breadcrumb-item">
                  <a href="{% url 'work:select_install' type=type %}">{{type}}</a>
                </li>
                <li class="breadcrumb-item active" aria-current="page">
                  <a href="{% url 'work:before_install' type=type %}">설치작업 전</a>
                </li>
                <li class="breadcrumb-item active" aria-current="page">
                  체크리스트
                </li>
              </ol>
            </nav>
          </div>
        </div>
      </div>
    </section>
    {% include 'util/pdfbtn.html' %}
    <section id="checklist">
      <div class="container border">
        <div class="row m-1">
          <h1>
            {{checklist.equipment}} 설치작업 전 점검 체크리스트
          </h1>
        </div>
        <table class="table table-bordered">
          <tr>
            <th scope="row" class="table-secondary align-middle" style="width: 15%">문서번호</th>
            <td class="align-middle" style="width: 35%">{{checklist.equipment}} 설치작업 전 점검 체크리스트-{{checklist.pk}}</td>
            <th scope="row" class="table-secondary align-middle" style="width: 15%">설치 위치</th>
            <td style="width: 35%">
              <div class="row">
                <div class="col">
                  {{checklist.locateId.class2.class1.class1}} - {{checklist.locateId.class2.class2}} -
                  {{checklist.locateId.class3}}
                </div>
              </div>
              <div class="row p-2">
                <div class="col">
                  {{checklist.detailLocate}}
                </div>
              </div>
            </td>
          </tr>
          <tr>
            <th scope="row" class="table-secondary align-middle">확인 일자</th>
            <td>
              {{checklist.date}}
            </td>
            <th scope="row" class="table-secondary align-middle">담당자</th>
            <td class="align-middle">
              <div class="row">
                <div class="col">
                  {{checklist.writerId.name}}
                </div>
                <div class="col">
                  <img width='60%' alt='' src='{{checklist.writerId.signImage.url}}' />
                </div>
              </div>
            </td>
          </tr>
          <tr>
            <th scope="row" class="table-secondary align-middle">제목</th>
            <td colspan="3">
              {{checklist.title}}
            </td>
          </tr>
        </table>
        <table class="table table-bordered text-break">
          <thead>
            <tr class="table-primary">
              <th scope="col" rowspan=2 style="width: 5%">NO</th>
              <th scope="col" rowspan=2 style="width: 65%">점검 항목</th>
              <th scope="col" colspan=2 style="width: 20%">점검 결과</th>
              <th scope="col" rowspan=2 style="width: 10%">조치 사항</th>
            </tr>
            <tr class="table-primary">
              <th>
                양호
              </th>
              <th>
                미흡
              </th>
            </tr>
          </thead>
          <tbody>
            {% for checkmenu in checklist.before_inspection_result.all %}
            <tr>
              <td>{{forloop.counter}}</td>
              <td class="text-start">{{checkmenu.before_inspection_item_id.title}}</td>
              <td>
                {% if checkmenu.result == "1" %}
                <i class="bi bi-check"></i>
                {% endif %}
              </td>
              <td>
                {% if checkmenu.result == "2" %}
                <i class="bi bi-check"></i>
                {% endif %}
              </td>
              <td>
                {% if checkmenu.content %}
                <i class="bi bi-circle"></i>
                {% endif %}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        <div class="row m-1">
          <h3>조치 사항</h3>
        </div>
        <table class="table table-bordered text-break">
          <thead>
            <tr class="table-primary">
              <th scope="col" style="width: 5%">NO</th>
              <th scope="col" style="width: 10%">작성자</th>
              <th scope="col" style="width: 40%">내용</th>
              <th scope="col" style="width: 45%">사진</th>
            </tr>
          </thead>
          <tbody class="align-middle">
            {% for checkmenu in checklist.before_inspection_result.all %}
            {% if checkmenu.before_measure.first %}
            <tr>
              <td>{{forloop.counter}}</td>
              <td colspan=3 style="padding: 0;">
                <table id="{{checkmenu.pk}}-table" class="table table-bordered text-break align-middle m-0">
                  {% for measure in checkmenu.before_measure.all %}
                  <tr>
                    <td style="width: 10.526315789473685%">
                      {% if measure.isCM %}
                      {{measure.cm.name}}
                      {% else %}
                      {{checklist.writerId.name}}
                      {% endif %}
                    </td>
                    <td style="width: 42.10526315789474%">
                      {{measure.content}}
                    </td>
                    <td style="width: 47.36842105263158%">
                      {% for image in measure.before_measure_imgs.all %}
                      <img class="m-4" width='85%' alt='' src='{{image.img.url}}' />
                      {% endfor %}
                    </td>
                  </tr>
                  {% endfor %}
                </table>
              </td>
            </tr>
            {% endif %}
            {% endfor %}
          </tbody>
        </table>
      </div>
    </section>
  </div>
  <br><br><br><br><br>
</main>
{% endblock %}

{% block javascript %}

{% include 'util/pdfsave.html' with save_btn="save_btn" target_div="checklist" file_name=checklist.equipment|add:"설치작업 전 체크리스트" docNum=checklist.pk %}

{% endblock %}